name: temp

on:
  workflow_dispatch:

jobs:

  temp:

    name: temp
    runs-on: ubuntu-latest

    steps:

      - name: Get current latest image id
        run: >
          wget
          --header="Authorization: token ${{ secrets.GHCR_PAT }}"
          --header="Accept: application/vnd.github.v3+json"
          -nv
          -O - https://api.github.com/user/packages/container/blog-application/versions
          | python3 -c
          "import os, sys, json;
          data = json.load(sys.stdin);
          latest_id = data[0]['id'];
          print(latest_id);
          os.environ['LATEST_IMAGE_VERSION'] = str(latest_id);"
          && echo "${{ env.LATEST_IMAGE_VERSION }}"
